---
title: "Clase 4: Blogdown y Bookdown"
author: Lucio Cornejo
---
class: center, middle, inverse, title-slide

```{r setup, include=FALSE}
xaringanExtra::use_panelset()
xaringanExtra::use_tile_view()
xaringanExtra::use_fit_screen()
knitr::opts_chunk$set(echo = TRUE)
```

<h1 class = "celeste-ish" style="line-height: 90px; margin-top: -50px;">
    Clase 4:
    <p style="margin-bottom: -170px;"> &nbsp; </p>
    Blogdown y Bookdown
</h1>

<h3 class = "celeste-ish" style = "position: absolute; bottom: 80px;">
  Autor: Lucio Cornejo
</h3>

---

## Contenido extra para la sesión pasada

- **Xaringan** 
    - La opción `highlightStyle` del YAML de un archivo con `output`
    Xaringan permite algunos valores diferentes al valor
    `highlight` de un archivo con `output` html\_document,
    tal como el tipo de resaltado **dracula**.

    - Otras maneras de crear diapositivas en **R Markdown**:
        - reveal.js
            - <https://bookdown.org/yihui/rmarkdown/revealjs.html>
            - <https://e-gor.github.io/Reveal.js-TOC-Progress/demo/#/>

        - slidy_presentation
            - <https://bookdown.org/yihui/rmarkdown/slidy-presentation.html>
            - <https://pebiba-taller-rmd.netlify.app/index.html#(1)>
    
    - Problema respecto a la [tabla de contenidos](https://github.com/yihui/xaringan/issues/217).
    
    - Convertir las diapositivas a **PDF**:
        - Paquete **pagedown**
      
<p style="margin-bottom: -30px;"> &nbsp; </p>

- **Sitio web básico creado con R Markdown** 

    - Uso de la función `rmarkdown::render_site()`.
    
    - Uso del archivo `_output.yml`.
    
    - ¿Cómo añadir íconos al sitio web?
        - [Cómo obtener el script necesario.](https://www.youtube.com/watch?v=BATVa4vGZto&ab_channel=EasyTutorials)
        - [Algunas opciones de iconos.](https://www.w3schools.com/icons/icons_reference.asp)

???

Mostrar cómo incluir el script para íconos y el ícono para la 
página principal del sitio, en la carpeta del sitio web,
vía el archivo **_site.yml** 

---

## Distill

### Sitios web creados con Distill

<https://www.jvcasillas.com/>

<https://pkgs.rstudio.com/distill/articles/examples.html>

<p style="margin-bottom: -30px;"> &nbsp; </p>


### ¿Por qué usar Distill para crear un sitio web?

Es un formato más estable que **Blogdown**, ya que no
requiere de **Hugo**, así que se evita problemas de compatibilidad
(presentes o futuros) entre **Hugo** y **Blogdown**.

<p style="margin-bottom: -50px;"> &nbsp; </p>

> _La idea fue crear una platforma para ayudar a científicos a aprovechar_
> _los beneficios de la comunicación moderna vía HTML, la cual diseñadores_
> _digitales y periodistas han estado usando para crear artículos_
> _interactivos y atractivos ubicados donde están los lectores:_<br>
> ***en línea (online)***.<br>
> --- https://www.rstudio.com/blog/distill/

???

Comentar sobre el problema actual de compatibilidad de mi
[página](https://lucio-cornejo.github.io/) 
de Mathematical Music theory.

---

## Manos a la obra

- Creación del sitio web<br>

```{r, eval = FALSE}
distill::create_blog(dir = "nombre_carpeta", title = "nombre_sitio_web")
```

- Acceder al archivo `_site/index.html`, página principal del sitio web creado.

- Configuremos el archivo `_posts/welcome/welcome.Rmd`, lo renderizamos
y regresamos a la páginal principal del sitio web.

- Creación de un nuevo post<br>

```{r, eval = FALSE}
distill::create_post(title = "titulo_publicacion", draft = FALSE)
```

Podemos emplear `draft=TRUE` para que tal publicación no se muestre 
en el sitio web, ya que sería un _borrador_. En el **encabezado YAML**
de aquella publicación podemos cambiar `draft: FALSE` cuando 
el documeto este listo para ser publicado.

???

`create_blog(...) vs create_website(...)` 

- "Blogs Distill" son "sitios web Distill" con extra funcionalidades.
- Para un "blog Distill" es posible que las publicaciones se añadan
automáticamente con su preview y link en la homepage; sin embargo,
eso se tendría que hacer manualmente para "sitios web Distill".
- Cuando se reconstruye un "sitio web Distill", las publicaciones se
renderizan de nuevo, pero eso no ocurre para los "blog Distill", evitando
así posible problemas de compatibilidad tras actualizar paquetes de **RR**.

---

<p style="margin-bottom: -30px;"> &nbsp; </p>

- Definir el **preview** de la publicación.

- Una **tabla de contenidos** diferente a la que hemos estado empleando.
    
    - `toc: true` 
    - `toc_float: false` 

- Propiedad `code_folding: true` &nbsp;y creación de links para secciones de código.

- Añadir `categories: ["alguna_categoria"]` &nbsp;a la publicación creada y ver el
cambio que produce en la página principal del sitio web.

- Personalizar el diseño del sitio web

    - [Alternativa más rápida](https://rstudio.github.io/distill/website.html#theming)
    (no me funciona)
    - Crear un archivo **CSS** donde modificamos el estilo del sitio,
    y lo incluimos adecuadamente vía el `_site.yml` del sitio web.
        - Esconder la categoría `articles` de la página principal del sitio web.

---
class: middle

- Añadir sección de comentarios y para compartir la publicación:
    - Insertar el siguiente código al archivo `_site.yml` y cambiar
    el valor de `base_url` por el link con el cual se accederá al blog
    creado con **Distill** tras haberlo subido online:
    
      ```yaml
      base_url: https://mathematical-music-theory-blog.netlify.app/
      collections:
        posts:
          disqus:
            shortname: comentarios # nombre cualquiera, pero obligatorio
            hidden: true 
          share: [twitter, linkedin, facebook, google-plus, pinterest]
      ``` 
- Esconder los anuncios (versión Desktop) en la sección de comentarios, 
modificando apropiadamente el archivo `CSS` señalado en `_site.yml`.

- [Más propiedades](https://ymlthis.r-lib.org/reference/yml_distill_opts.html)
para incluir en el **encabezado YAML** de nuestros documentos creados con Distill.

---

<p style="margin-bottom: -70px;"> &nbsp; </p>

## Publicación del blog creado con Distill

<p style="margin-bottom: -80px;"> &nbsp; </p>

1. Ejecutamos `rmarkdown::render_site()` tras haber fijado como directorio
  aquel donde se encuentra el archivo **index.Rmd**.
1. En **GitHub**, creamos un repositorio con el mismo nombre que el nombre
  de la carpeta principal de nuestro blog Distill.
1. Ejecutamos en alguna terminal los siguientes comandos, tras cambiar 
  adecuadamente las secciones **ruta-de-la-carpeta-del-blog-Distill**,
  **nombre-de-usuario** y **nombre-del-repositorio**:

  <p style="margin-bottom: -85px;"> &nbsp; </p>
  
  .scrollable[
  ```text

  cd ruta-de-la-carpeta-del-blog-Distill
  git add .
  git commit -m "initial commit"
  git remote add origin https://github.com/nombre-de-usuario/nombre-del.repositorio.git
  git branch -M main
  git push -u origin main
  ```
  ]

1. Cuando publiquemos el sitio web via **Netlify** y **GitHub**, 
en la sección **Publish directory** escribimos **_site**.
---
class: middle

## Referencias para Distill

- <https://themockup.blog/posts/2020-08-01-building-a-blog-with-distill/>
- <https://rstudio.github.io/distill/blog.html>
- <https://rstudio.github.io/distill/metadata.html>
- <https://rstudio.github.io/distill/>

---
class: middle

## Blogdown

### Ejemplos de blog creados con R Markdown

- <https://malco.io/>
- <https://desiree.rbind.io/>
- <https://hugo-apero-docs.netlify.app/>

Lamentablemente, actualmente ya
[no funciona](https://github.com/rstudio/blogdown/issues/638)
el modelo mostrado, **hugo-acadecmic** (gcushen/hugo-academic),
con **Blogdown**.

Sin embargo, pueden emplear un modelo 
[parecido](https://themes.gohugo.io/themes/meghna-hugo/).

---

## Creamos un sitio web con el paquete Blogdown

Pasos para crear nuestro sitio web con **R Markdown** y el paquete **Blogdown**:<br>
1. Crear un nuevo repositorio en GitHub.
1. En RStudio, crear un nuevo proyecto vía un link del repositorio creado.
1. Ejecutar el siguiente código:
    ```r
    # Instalaciones
    install.packages("blogdown")
    blogdown::install_hugo()
    blogdown::hugo_version() # debe ser más actual que "0.80.0"

    # Creamos el sitio web
    library(blogdown)
    #new_site(theme = "themefisher/meghna-hugo") # otra plantilla
    new_site(theme = "hugo-apero/hugo-apero", 
              format = "toml",
              sample = FALSE,
              empty_dirs = TRUE)
    ```

---

## Modificaciones básicas para personalizar el sitio web

<p style="margin-bottom: -80px;"> &nbsp; </p>

- `config.toml` &nbsp;&nbsp;&nbsp;&nbsp; (comparar con el de mi portafolio)
    <p style="margin-bottom: -60px;"> &nbsp; </p>
    - `title` 
    - `author` 
    - `[params]` 
        - Cambiar `favicon` y `logo` vía
        `themes/hugo-apero/static/img`&nbsp;&nbsp;.
        - `theme` 
        - `customtextFontFamily` 
        - `customheadingFontFamily`
    - `[menu]`

<p style="margin-bottom: -70px;"> &nbsp; </p>

- Para otras plantillas, se suele emplear el comando `blogdown::build_site()` 
para que se actualicen los documentos del sitio web 
(análogo a la función `rmarkdown::render_site()` que ya hemos visto).
Sin embargo, para esta plantilla (hugo-apero), basta `push` los cambios 
al repositorio asociado a este blog 
(el cual también se ha vinculado con **Netlify**)
para que se actualice la versión online del blog creado.

???

Tras publicar el blog en **Netlify**, cambiar el `baseURL` en el archivo
`config.toml` por el link del blog online, por ejemplo: <br>
`baseURL = "https://hugo-apero-docs.netlify.app/"`

---
class: middle

- Para incluir cambios personalizados para el diseño visual **(CSS)**
del blog, <br>
modificar el archivo `themes/hugo-apero/assets/custom.scss`.<br>
Para aplicar aquellas alteraciones al blog, en el archivo
`config.toml` incluir en la línea 58 (del archivo default) 
`custom_theme = "custom"` &nbsp;.

- También puedes añadir código de **JavaScript** que desees se aplique en cada
página del blog, incluyendo tal código en el archivo<br>
`themes/hugo-apero/assets/js/main.js` &nbsp;&nbsp;.

- Asimismo, es posible añadir contenido a la sección `head` de cada
sitio web del blog, modificando adecuadamente el archivo<br>
`theme/hugo-apero/layouts/partials/head.html` &nbsp;&nbsp;.

- `content/_index.md` &nbsp;&nbsp;&nbsp;&nbsp;(homepage)
<p style="margin-bottom: -60px;"> &nbsp; </p>
    - `description, image_left, title, ...`
    - `images` &nbsp;&nbsp;(`themes/hugo-apero/static/img`)

---
class: middle

- `content/blog/_index.md` 
<p style="margin-bottom: -60px;"> &nbsp; </p>

    - `sidebar` &nbsp;&nbsp;(la imagen debe llamarse `sidebar-listing` &nbsp;)
    - `layout` 
        - list (blogs, projects, talks)
        - list-sidebar (blogs, projects, talks)
        - list-grid (solo blogs y projects)

- **Cada sección es configurada por su archivo &nbsp;`_index.md`**&nbsp;&nbsp;.

- **Los thumbnails deben llamarse &nbsp;`featured`&nbsp;**
**(o contener esa palabra en el nombre (ej: `mario-featured.png`))**
**para que Hugo los reconozca como thumbnails**.

- Creamos una nueva publicación en la sección **blog** via el 
**RStudio** addin _New Post_:
    - Señalamos la extensión
    [**Rmarkdown**](https://bookdown.org/yihui/blogdown/output-format.html)
    - Como contenido de aquella publicación, emplearemos el modelo
    de la siguiente diapositiva.

???

Explicar por qué se usa la extensión **.Rmarkdown** y **.markdown** 
en vez de **.Rmd** y **html**.

---

```` 
---
author: Yoshi
layout: single
date: '2022-02-01'
excerpt: |
  Resumen corto.
title: Ejemplo
---

## Ejemplos

```{r}`r ''`
DT::datatable(mtcars)
```

```{r}`r ''`
plot(pressure)
```

Ecuación $e^{i\pi} +1 = 0$ en línea.

$$
\sin^2\theta + \cos^2\theta = 1
$$
````

---

- Configuramos la sección **About** del blog:
  <p style="margin-bottom: -70px;"> &nbsp; </p>

  - Solo realizar los siguientes cambios en `content/about/_index.md` &nbsp;:
  <p style="margin-bottom: -50px;"> &nbsp; </p>

      - `description` 
      - `show_header` 
      - `sidebar_left` 

  - Cambiar todas las propiedades en `content/about/header/index.md` &nbsp;.

  - `content/about/main/index.md`
      <p style="margin-bottom: -50px;"> &nbsp; </p>
      
      - `number_featured` 
      - `intro` 

  - `content/about/sidebar/index.md`
      <p style="margin-bottom: -50px;"> &nbsp; </p>

      - `author` 
      - `role` 
      - `avatar_shape` 
          - La imagen en esa ruta debe llamarse **avatar**
          para que se muestre en el esta parte del blog.
      - `show_social_links` 
      - `audio_link_label` 
          - El audio en aquel directorio debe llamarse **audio** 
          para que se reconozca y se le apliquen estos cambios.
      - `link_list` 

---

class: middle

- Podemos incluir botones como los de la publicación **Palmer Penguins** 
en la sección **Projects**. Para ello, veamos el archivo 
&nbsp;`content/project/penguins/index.md`&nbsp;&nbsp;.

- Es posible crear **series** en las publicaciones del blog, por ejemplo,
siguiendo el modelo de la plantilla para **spoonful-series**, copiando la carpeta,
pegándola y alterándola adecuadamente; por ejemplo, cambiando el nombre a
**xaringan-series** (`series` es necesario en el nombre para ser reconocida como tal)
y alterando la propiedad `series` en el archivo `_index.md` de la carpeta _clonada_.

<p style="margin-bottom: 20px;"> &nbsp; </p>

## Referencias para Blogdown

- <https://hugo-apero-docs.netlify.app/start/>
- <https://www.youtube.com/watch?v=RksaNh5Ywbo&ab_channel=R-LadiesTunis>
- <https://www.apreshill.com/slides/blogdown-workshop-slides.html#1>

---

## Bookdown

- [Modelo básico para crear el libro](https://github.com/seankross/bookdown-start)

- Modificaciones básicas
    - `_output.yml` 
        - Cambiar el título "A Minimal Bookdown Book"
    - 


---

## Referencias para Bookdown

- <https://seankross.com/2016/11/17/How-to-Start-a-Bookdown-Book.html>
